**信号量**

信号量的使用主要是用来保护共享资源,使得资源在一个时刻只能由一个进程或线程所拥有

信号量的值为正的时候,说明它空闲,所测试的线程都可以锁定而使用它,如果为0, 说明他被占用,测试的线程要进入睡眠队列中,等待被唤醒

**信号量的分类**
Linux 提供两种信号量

- 内核信号量, 由内核控制路径使用
- 用户态进程使用的信号量,这种信号量又分为POSIX信号量和SYSTEM V 信号量

**内核信号量**

1. 内核信号量类似于自旋锁,当锁关闭时,他不允许内核控制路径继续进行,当内核控制路径试图获取内核信号量锁保护起来的忙资源时,相应的进程就被挂起,只有资源被什邡市,进程才再次变为可以运行.

   只有可以睡眠的函数才能获取内核信号量,中断处理程序和可延迟函数都不能使用 内核信号量.

**POSIX信号量与SYSTEM V 信号量**

1. 对于POSIX 信号量来说,信号量是个非负整数,常用于线程间同步.

   而SYSTEM V 信号量时一个或多个信号量的集合,它对应的时一个信号量结构体,这个结构体是为SYSTEM V IPC 服务的,信号量只不过是它的一部分,常用于进程间同步

2. POSIX 信号量的引用头文件是 “<semaphore.h>” ,而SYSTEM V 信号量的引用头文件时“<sys/sem.h>”

3. 从使用角度来讲, System V 信号量是复杂的,而POSIX信号量是简单的.比如POSIX 信号量的创建和初始化或PV操作就很方便.

**POSIX 信号量**

1. 无名信号量

   无名信号量的创建就像声明一个变量一样简单,然后再初始化该无名信号量,之后就可以放心使用了.

   无名信号量多用于多线程间的同步,同事也用于相关进程间的同步,也就是说无名信号量必须是多个进程或线程的共享变量,无名信号量要保护的变量必须时多个进程或线程的共享变量,这两个条件缺一不可

2. 有名信号量

   有名信号量的特点就是把信号量的值保存于文件中,决定了其可以用于线程,也可以用于相关进程间,甚至是不相关进程

   对于相关进程来说,子进程是继承了父进程的文件描述符,那么,子进程所继承的文件描述符所指向的文件和父进程一样,文件内保存的有名信号量就共享了.

sem: 优化https://www.iyunv.com/thread-218986-1-1.html

zabbix support: https://support.zabbix.com/browse/ZBX-3974















